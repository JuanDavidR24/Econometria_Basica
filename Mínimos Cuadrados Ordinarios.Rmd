---
title: "Mínimos Cuadrados Ordinarios"
author: "Juan David Rincón Mora"
output:
  pdf_document: default
  html_document: default
---

# 1. Introducción.

El objetivo principal de este cuaderno es estimar un modelo econométrico de interés económico mediante el método de **Mínimos Cuadrados Ordinarios (MCO, OLS)**. Se describirá detalladamente el proceso de construcción de matrices, la estimación de estadísticos y variables, y la interpretación de los resultados obtenidos.

Es importante señalar que este cuaderno se centra en el desarrollo de los diferentes estimadores y estadísticos necesarios para la estimación del modelo econométrico en términos de programación. No se profundizará en el desarrollo matemático detrás de los mismos, más allá de presentar las ecuaciones, fórmulas e interpretaciones correspondientes.

# 2. Modelo.

En este cuaderno se va a estimar el modelo **CAPM (Capital Asset Pricing Model)**, cuyo objetivo es explicar la rentabilidad de un activo financiero en función del riesgo de mercado que asume. Según Berk y DeMarzo (2008), el modelo matemático más sencillo del CAPM se expresa así:
$$r_{i} = r_{f} + \beta(E[R_{mkt}]-r_{f})$$
Donde $r_{i}$ representa la rentabilidad del activo a valorar, $r_{f}$ es la tasa libre de riesgo, $\beta$ es la sensibilidad de la rentabilidad del activo frente a cambios en la rentabilidad del portafolio de mercado, por lo tanto, representa una medida del riesgo sistémico, y $E[R_{mkt}]$ es el valor esperado de la rentabilidad del mercado, de donde se resta la tasa libre de riesgo, lo cual corresponde a la prima de riesgo del mercado.

Para estimar el modelo de forma econométrica, en primer lugar, se realiza una pequeña transformación a la expresión matemática. Se traslada el término de la tasa libre de riesgo $r_{f}$ al lado izquierdo de la ecuación, de modo que la variable dependiente sea la prima de riesgo que genera el activo por sí en relación con la tasa libre de riesgo. Esto da lugar a un nuevo parámetro $\alpha$, que representa el intercepto y cuya interpretación es la prima de riesgo natural del activo. Además, se añade el término de perturbación $\varepsilon_{t}$, que recoge toda aquella información no observable que afecta el modelo. De esta forma, la ecuación del modelo econométrico queda como sigue:$$(r_{t}^i-r_{t}^f) = \alpha + \beta(r_{t}^{mkt}-r_{t}^f) + \varepsilon_{t}$$Es importante destacar que el modelo se construye a partir de datos tipo **serie de tiempo**, lo cual explica que cada variable esté subindexada a un momento $t$ en particular. Los superíndices indican a qué tipo de rentabilidad corresponde cada componente según la notación inicial del modelo matemático.

## 2.1. Variables.

En este caso, se ha elegido a **Amazon** como el activo $r^{i}$ a valorar, identificado por su ticker de cotización AMZN. Dado que esta acción cotiza principalmente en el índice **NASDAQ Composite**, se ha tomado este índice como la rentabilidad de mercado $r^{mkt}$. Para la tasa libre de riesgo $r^{f}$, se ha utilizado la tasa de mercado en periodicidad mensual de los **Bonos del Tesoro de Estados Unidos a 10 años**, representada por el indicador UST10.

Se han tomado los valores correspondientes a los periodos de **enero de 2015 hasta diciembre de 2022**. Es importante aclarar que en el caso de AMZN y NASDAQ, no se han considerado los precios directamente, sino la rentabilidad mensual, es decir, el cambio porcentual respecto al último precio de cada mes.

La base de datos utilizada para este ejercicio está disponible en el siguiente enlace: [[*Datos CAPM Amazon*]{.underline}](https://github.com/JuanDavidR24/Econometria_Basica/blob/main/Datos%20CAPM%20Amazon.xlsx). A continuación se presentan los primeros valores de la base de datos:

```{r}
#install.packages("readxl")
library(readxl)

# Importar datos.
archivo <- file.choose()
DATA <- as.data.frame(read_excel(archivo, sheet = 1))

# Datos (Primeros Valores).
head(DATA)
```

### 2.1.1. Representación gráfica.

```{r, fig.width=7, fig.height=4}
#install.packages("ggplot2")
library(ggplot2)

# Gráfica Amazon Precios.
ggplot(data=DATA, aes(x = Fecha, y = AMZN)) + 
  geom_line(color = "blue") + 
  labs(x = "Año/Mes", y = "Precio $USD", 
       title = "Último precio mensual Amazon (AMZN)", 
       subtitle = "Enero 2015 - Diciembre 2022")

# Gráfica de Amazon Retornos.
ggplot(data=DATA, aes(x = Fecha, y = `AMZN Rtrn`)) + 
  geom_line(color = "blue") + 
  labs(x = "Año/Mes", y = "Retorno Mensual", 
       title = "Rentabilidad Mensual Amazon (AMZN)", 
       subtitle = "Enero 2015 - Diciembre 2022") +
  scale_y_continuous(labels = scales::percent)

# Gráfica NASDAQ Precios.
ggplot(data=DATA, aes(x = Fecha, y = NASDAQ)) + 
  geom_line(color = "red") + 
  labs(x = "Año/Mes", y = "Precio $USD", 
       title = "Último precio mensual Nasdaq Composite Index", 
       subtitle = "Enero 2015 - Diciembre 2022")

# Gráfica NASDAQ Retornos.
ggplot(data=DATA, aes(x = Fecha, y = `NASDAQ Rtrn`)) + 
  geom_line(color = "red") + 
  labs(x = "Año/Mes", y = "Retorno Mensual", 
       title = "Rentabilidad Mensual Nasdaq Composite Index", 
       subtitle = "Enero 2015 - Diciembre 2022") +
  scale_y_continuous(labels = scales::percent)

# Gráfica Bonos del Tesoro 10 años.
ggplot(data=DATA, aes(x = Fecha, y = `UST10 mv`)) + 
  geom_line(color = "black") + 
  labs(x = "Año/Mes", y = "Retorno Mensual", 
       title = "Tasa mensual Bonos del Tesoro de Estados Unidos a 10 años",
       subtitle = "Enero 2015 - Diciembre 2022") +
  scale_y_continuous(labels = scales::percent)
```

### 2.1.2. Construcción de variables del modelo.

En primer lugar se extraen en vectores individuales cada variable:

```{r}
# Amazon, Ri.
ri <- DATA$`AMZN Rtrn`

# Nasdaq, Rmkt.
rmkt <- DATA$`NASDAQ Rtrn`

# Bonos US 10y, Rf.
rf <- DATA$`UST10 mv`
```

Luego se construyen las variables que efectivamente se van a utilizar en el modelo, es decir, la prima de riesgo propia del activo y la prima de riesgo del mercado:

```{r}
# Prima del activo, Ri-Rf.
ri_rf <- ri - rf

# Prima del mercado, Rmkt-Rf.
rmkt_rf <- rmkt - rf
```

# 3. Estimación MCO, OLS.

Se realiza la estimación utilizando el método de Mínimos Cuadrados Ordinarios (MCO, OLS) del siguiente modelo en forma matricial: $$Y = X\beta + e$$Donde $Y$ es una matriz de tamaño $T \times 1$ que contiene los valores de la variable dependiente, $X$ es una matriz de diseño de tamaño $T \times K$ que contiene las variables independientes, $\beta$ es una matriz de tamaño $K \times 1$ que contiene los parámetros que relacionan las variables explicativas con la variable explicada, y $e$ es una matriz de tamaño $T \times 1$ que contiene las perturbaciones no observables.

## 3.1. Matrices de diseño.

De manera más específica, las matrices $Y$ y $X$, de las cuales se dispone la información y los datos, se construyen de la siguiente manera:$$Y = \begin{bmatrix} r_{1}^{i} - r_{1}^{f} \\ 
r_{2}^{i} - r_{2}^{f} \\ \vdots \\ 
r_{t}^{i} - r_{t}^{f}
\end{bmatrix}_{T \times 1}
\qquad
X = \begin{bmatrix} 
1 & r_{1}^{mkt}-r_{1}^{f} \\ 
1 & r_{2}^{mkt}-r_{2}^{f} \\ 
\vdots & \vdots \\
1 & r_{t}^{mkt}-r_{t}^{f} \end{bmatrix}_{T \times 2}$$

```{r}
# Matriz Y (Variable dependiente).
Y <- as.matrix(ri_rf)

# Matriz X (Variables independientes).
X <- cbind(1, rmkt_rf)

# Número de datos y variables.
N <- dim(X)[1]
K <- dim(X)[2]
```

## 3.2. Mínimos cuadrados ordinarios.

El estimador de Mínimos Cuadrados Ordinarios para los parámetros (betas) del modelo, de forma matricial, es el siguiente:$$\hat{\beta} = \left(X'X \right)^{-1} X'Y$$

```{r}
# Función OLS.
OLS.f <- function(X,Y){
  
  # Formula.
  B_gr <- solve(t(X)%*%X)%*%t(X)%*%Y
  
  # Resultado.
  return(B_gr)
}

# Betas Estimados.
B_gr <- OLS.f(X,Y)
B_gr
```

Las interpretaciones de los betas estimados son las siguientes:

1.  La prima de riesgo natural de Amazon, representada por el intercepto $\hat{\alpha}$, es de aproximadamente **0.9957%** mensual, manteniendo todo lo demás constante. Este coeficiente indica cuánta rentabilidad adicional genera el activo sin importar lo que suceda con la rentabilidad del mercado.

2.  Dado que $\hat{\beta}$ es mayor a 1, esto indica que Amazon es más volátil que el mercado, es decir, reacciona de manera amplificada a los movimientos positivos o negativos del NASDAQ. En particular, el valor del coeficiente indica que ante un aumento de 1% (0.01 en la magnitud de los datos) en la prima de riesgo del mercado, la prima de riesgo de Amazon aumenta aproximadamente **1.2685%** (0.012685), manteniendo todo lo demás constante.

## 3.3. Estimación variable dependiente.

Para hallar la variable dependiente estimada se multiplica la matriz $X$ de variables independientes por el vector $\hat{\beta}$ de parámetros estimados por OLS.$$\hat{Y} = X \hat{\beta}$$

```{r}
# Variable dependiente estimada.
Y_gr <- X%*%B_gr
head(Y_gr)
```

## 3.4. Estimación errores.

Para estimar las perturbaciones, que en principio no son observables, se restan los valores reales de la variable dependiente y los valores estimados por el modelo.$$\hat{e} = Y - \hat{Y}$$

```{r}
# Errores estimados.
e_gr <- Y - Y_gr
head(e_gr)
```

## 3.5. Varianza estimada de los errores.

El estimador insesgado para la varianza de las perturbaciones del método OLS se calcula de la siguiente manera:$$\hat{\sigma}^2 = \frac{\hat{e}' \cdot \hat{e}}{T-K}$$

```{r}
# Función de varianza estimada.
sigma2_gr.f <- function(residuales, T_obs, K_var){
  
  # Formula.
  sigma2_gr <- as.numeric((t(residuales)%*%residuales)/(T_obs-K_var))
  
  # Resultado.
  return(sigma2_gr)
}

# Varianza estimada.
sigma2_gr <- sigma2_gr.f(e_gr, N, K)
sigma2_gr

# Desviación Estándar estimada.
sigma_gr <- sqrt(sigma2_gr)
sigma_gr
```

## 3.6. Matriz de Varianza-Covarianza de los betas.

La matriz de Varianza-Covarianza de los betas estimados por OLS se calcula de la siguiente manera:$$\sum_{\hat{\beta}} = \mbox{VarCov}(\hat{\beta}) =\hat{\sigma}^2 \left(X'X \right)^{-1}$$Para la cantidad de regresores de este modelo, la matriz contiene la siguiente información:$$\sum_{\hat{\beta}} = \mbox{VarCov}(\hat{\beta}) = 
\begin{bmatrix} 
Var(\hat{\alpha}) & Cov(\hat{\alpha},\hat{\beta}) \\
Cov(\hat{\beta},\hat{\alpha}) & Var(\hat{\beta}) \\
\end{bmatrix}_{K \times K}$$

```{r}
# Matriz de Varianza Covarianza.
varcov_beta_gr <- sigma2_gr*solve(t(X)%*%X)
varcov_beta_gr

# Desviaciones estándar de los betas.
sd_beta_gr <- sqrt(diag(varcov_beta_gr))
sd_beta_gr
```

## 3.7. Coeficiente de determinación.

Para medir la bondad de ajuste del modelo se utiliza el coeficiente de determinación $R^2$, el cual representa el porcentaje de variabilidad de la variable dependiente que es explicada por la variabilidad de las variables explicativas del modelo. La forma de calcular el estadístico es la siguiente:$$R^2 = \frac{SEC}{STC} = \frac{\sum_{t=1}^{T}{(\hat{Y}_{t}-\bar{Y})^2}}
{\sum_{t=1}^{T}{(Y_{t}-\bar{Y})^2}}$$

```{r}
# Función Coeficiente de determinación R2.
R2.f <- function(Y, Y_gr){
  
  # Suma explicada de cuadrados.
  sec <- sum((Y_gr-mean(Y))^2)
  
  # Suma total de cuadrados.
  stc <- sum((Y-mean(Y))^2)
  
  # Formula.
  R2 <- as.numeric(sec/stc)
  
  # Resultado.
  return(R2)
}

# Coeficiente de determinación R2.
R2 <- R2.f(Y, Y_gr)
R2
```

Este resultado indica que aproximadamente el **55%** de la variabilidad de la prima de riesgo de Amazon puede ser explicada por la variabilidad de la prima de riesgo del mercado NASDAQ.

### 3.7.1. Coeficiente de determinación ajustado.

Uno de los inconvenientes que tiene el $R^2$ como medida de bondad de ajuste es que su valor tiende a aumentar a medida que se añaden nuevas variables explicativas al modelo. Esto puede llevar a la interpretación errónea de que un modelo con más variables siempre es mejor. En realidad, algunas de estas variables adicionales pueden carecer de una relación económica coherente con el modelo o no ser estadísticamente significativas.

Para abordar este problema, se introduce el coeficiente de determinación ajustado, que penaliza el aumento del $R^2$ a medida que se agregan más variables al modelo. Este coeficiente se define de la siguiente manera: $$R_{adj}^2 = 1 - \frac{T-1}{T-k-1} (1-R^2)$$Donde $R^2$ es el coeficiente de determinación normal, $T$ es el número de observaciones total, y $k$ es el número de regresores sin el intercepto.

Cabe aclarar que en este caso particular, dado que el modelo solo tiene un regresor aparte del intercepto, no es necesario utilizar el coeficiente de determinación ajustado. Sin embargo, con el fin de proporcionar una comprensión más completa y con fines educativos, se presenta a continuación el resultado del cálculo del $R^2$ ajustado.

```{r}
# Función R2 ajustado.
R2adj.f <- function(R2, T_obs, K_var){
  
  # Formula.
  R2adj <- 1-((1-R2)*((T_obs-1)/(T_obs-(K_var-1)-1)))
  
  # Resultado.
  return(R2adj)
}

# Coeficiente de determinación R2 ajustado.
R2adj <- R2adj.f(R2, N, K)
R2adj
```

Este resultado indica que, ajustado bajo el número de regresores, aproximadamente el **54.5%** de la variabilidad de la prima de riesgo de Amazon es explicada por la variabilidad de la prima de riesgo del mercado NASDAQ.

# 4. Uso del modelo.

```{r, fig.height=4, fig.width=7}
# Data frame provisional.
df1 <- as.data.frame(cbind(ri_rf, rmkt_rf))

# Gráfica.
ggplot(df1, aes(x=rmkt_rf, y=ri_rf)) + 
  geom_point(color="blue", pch=18) + 
  geom_abline(color="red", intercept = B_gr[1], slope = B_gr[2]) +
  labs(x = "Prima de riesgo del mercado, (Rmkt - Rf)",
       y = "Prima de riesgo del activo, (Ri - Rf)",
       title = "CAPM Amazon",
       subtitle = paste("Y =", round(B_gr[1],6), "+", round(B_gr[2],6), "X")) +
  scale_y_continuous(labels = scales::percent) +
  scale_x_continuous(labels = scales::percent)
```

## 4.1. Pronóstico.

Una vez obtenidos los coeficientes de la regresión lineal, es posible utilizarlos para predecir y evaluar la rentabilidad futura de Amazon. Este proceso es sencillo y se logra mediante la sustitución de cualquier valor deseado de la prima de mercado en la forma funcional del modelo de regresión, o mediante la multiplicación de un vector transpuesto de información por la matriz de coeficientes estimados.$$\hat{y}_{t} = \hat{\alpha} + x_{t}\hat{\beta} \quad ó \quad \hat{y}_{t} = x'_{t}\hat{\beta}$$De esta manera, se puede obtener una estimación de la rentabilidad futura de Amazon utilizando los datos históricos y los patrones encontrados en el modelo de regresión lineal. Este enfoque permite a los inversores anticipar posibles resultados y tomar decisiones informadas sobre la inversión en acciones de Amazon en el futuro.

### 4.1.1. Pronóstico dentro de muestra.

A partir de las variables dependientes estimadas $\hat{Y}$, se pueden comparar con los valores efectivamente realizados, en este caso $y_{t} = r_{t}^i-r_{t}^f$.

```{r, fig.height=4, fig.width=7}
# Data frame provisional.
df2 <- data.frame(Fecha = DATA$Fecha, Y_gr = Y_gr, ri_rf = ri_rf)

# Gráfica pronóstico dentro de muestra.
ggplot(df2, aes(x=Fecha)) + 
  geom_line(aes(y=ri_rf, linetype="Efectiva", color="Efectiva")) +
  geom_line(aes(y=Y_gr, linetype="Estimación", color="Estimación")) + 
  labs(title = "Prima de riesgo Amazon: Efectiva vs Estimada",
       subtitle = "Enero 2015 - Diciembre 2022",
       x = "Año/Mes", y = "Prima de Riesgo del activo",
       linetype = "", color = "") +
  scale_linetype_manual(values = c("Efectiva"="solid", "Estimación"="dashed")) +
  scale_color_manual(values = c("Efectiva"="black", "Estimación"="red")) +
  scale_y_continuous(labels = scales::percent)
```

Al analizar las series, se puede notar que en varios puntos la estimación se asemeja a la realización efectiva, en algunos puntos la estimación es muy cercana y en otros está alejada de la realización efectiva. Sin embargo, en algunos casos, la dirección de la estimación es completamente opuesta a la de la realización.

Para medir el error de estimación promedio dentro de la muestra, se calcula el promedio aritmético del valor absoluto de los errores estimados $\hat{e}$. No se toma el promedio con los datos tal cual debido a que por propiedades de la estimación dicho promedio siempre será igual a cero. Por lo tanto, se utiliza el valor absoluto para evitar este problema y obtener una medida más precisa del error de la estimación.

```{r}
# Promedio valor absoluto de los errores.
mean(abs(e_gr))
```

El resultado obtenido indica que, considerando los datos de la muestra, se espera que el modelo tenga un error promedio de aproximadamente el **4.73%**, ya sea positivo o negativo, al estimar la prima de riesgo de Amazon.

Para evaluar la dirección de la estimación, se va a calcular el porcentaje de coincidencias, es decir, se contarán aquellas estimaciones cuya dirección positiva o negativa coincida con la dirección de la realización de la variable. De esta manera, se podrá determinar con mayor precisión la capacidad del modelo para predecir la dirección adecuada de la prima de riesgo de Amazon.

```{r}
# Vector de coincidencias.
dCoinc <- (Y > 0) == (Y_gr > 0)

# Porcentaje de aciertos.
sum(dCoinc)/N
```

El resultado obtenido indica que el **76.04%** de las estimaciones coinciden en dirección con la variable efectivamente realizada, mientras que el **23.96%** restante son estimaciones cuya dirección es contraria a la verdadera.

### 4.1.2. Pronóstico fuera de muestra.

Para analizar el pronóstico del modelo fuera de muestra, y dado que los datos están cerca de diciembre de 2022, se llevarán a cabo dos tipos de análisis: 1) La estimación y comparación de datos anteriores a la muestra, específicamente de **enero de 2013 a diciembre de 2014**, y 2) La comparación de los datos más recientes posteriores a la muestra, que en este caso abarcan solamente los meses de enero, febrero, marzo y abril de 2023.

```{r, fig.height=4, fig.width=7}
# Importar datos fuera de muestra.
DATA0 <- as.data.frame(read_excel(archivo, sheet = 2))

# Datos (Primeros Valores).
head(DATA0)

# Variables iniciales.
ri_0 <- DATA0$`AMZN Rtrn`
rmkt_0 <- DATA0$`NASDAQ Rtrn`
rf_0 <- DATA$`UST10 mv`

# Variables del modelo.
ri_rf_0 <- ri_0 - rf_0
rmkt_rf_0 <- rmkt_0 - rf_0

# Matrices de diseño.
Y0 <- as.matrix(ri_rf_0)
X0 <- cbind(1, rmkt_rf_0)

# Pronóstico.
Y0_gr <- X0%*%B_gr

# Data frame provisional.
df3 <- data.frame(Fecha = DATA0$Fecha, Y0_gr = Y0_gr, ri_rf_0 = ri_rf_0)

# Gráfica pronóstico dentro de muestra.
ggplot(df3, aes(x=Fecha)) + 
  geom_line(aes(y=ri_rf_0, linetype="Efectiva", color="Efectiva")) +
  geom_line(aes(y=Y0_gr, linetype="Estimación", color="Estimación")) + 
  labs(title = "Prima de riesgo Amazon: Efectiva vs Estimada",
       subtitle = "Enero 2013 - Diciembre 2014",
       x = "Año/Mes", y = "Prima de Riesgo del activo",
       linetype = "", color = "") +
  scale_linetype_manual(values = c("Efectiva"="solid", "Estimación"="dashed")) +
  scale_color_manual(values = c("Efectiva"="black", "Estimación"="red")) +
  scale_y_continuous(labels = scales::percent)

# Promedio valor absoluto de los errores.
e0_gr <- Y0 - Y0_gr
mean(abs(e0_gr))

# Vector de coincidencias.
dCoinc0 <- (Y0 > 0) == (Y0_gr > 0)

# Porcentaje de aciertos.
sum(dCoinc0)/length(Y0)
```

A partir de estos resultados se puede observar que la capacidad de pronóstico del modelo no difiere significativamente cuando se evalúa con datos fuera de la muestra. La serie de rentabilidad estimada de Amazon, graficada junto con la realización efectiva de la rentabilidad durante 2013 y 2014, muestra un comportamiento similar en la mayoría de los puntos. Específicamente, para este caso de comparación, se encontró que el promedio del valor absoluto de los errores de estimación (positivos o negativos) fue de **4.65%**, y en cuanto a la estimación de la dirección, el porcentaje de aciertos fue de aproximadamente el **79.17%**.

A continuación, se evaluará la calidad de pronóstico del modelo utilizando los datos más recientes posteriores a la muestra. Para ello, se utilizarán los datos de rentabilidad mensual del NASDAQ y la tasa libre de riesgo correspondientes al período de enero a abril de 2023.

|         | Rentabilidad mensual NASDAQ | Tasa libre de riesgo mensual UST10Y |
|------------------|:----------------------:|:----------------------------:|
| Enero   |           10.68%            |               0.2894%               |
| Febrero |           -1.11%            |               0.3206%               |
| Marzo   |            6.69%            |               0.2866%               |
| Abril   |            0.04%            |               0.2832%               |

Con esta información se construyen de manera individual los vectores con los datos correspondientes a cada mes y se realiza el pronóstico.

```{r}
# Vectores de información.
xene <- c(1, 0.1068 - 0.002894)
xfeb <- c(1, -0.0111 - 0.003206)
xmar <- c(1, 0.0669 - 0.002866)
xabr <- c(1, 0.0004 - 0.002832)

# Pronóstico.
pronM <- matrix(NA, nrow = 4, ncol = 2)
pronM[1,] <- c("Enero", round(xene%*%B_gr, 6))
pronM[2,] <- c("Febrero", round(xfeb%*%B_gr, 6))
pronM[3,] <- c("Marzo", round(xmar%*%B_gr, 6))
pronM[4,] <- c("Abril", round(xabr%*%B_gr, 6))
pronM
```

|         | Prima de riesgo efectiva Amazon | Estimación prima de riesgo | Error de estimación |
|------------------|:-----------------:|:----------------:|:----------------:|
| Enero   |             22.48%              |           14.18%           |        8.3%         |
| Febrero |             -8.95%              |           -0.82%           |       -8.13%        |
| Marzo   |              9.33%              |           9.12%            |        0.2%         |
| Abril   |              2.09%              |           0.69%            |        1.40%        |

Los resultados indican que el error absoluto de estimación promedio es del **4.51%** y que en todos los pronósticos realizados, el modelo acertó en la dirección del cambio porcentual o rentabilidad.

# 5. Conclusiones.

En este documento se planteó el objetivo de construir un modelo CAPM para valorar y estimar la rentabilidad mensual de Amazon (AMZN), utilizando la rentabilidad mensual del mercado NASDAQ y la tasa libre de riesgo medida como la tasa de mercado convertida a mensual de los bonos del tesoro de Estados Unidos a 10 años. El ejercicio se realizó con fines pedagógicos para repasar paso a paso el proceso de estimación y su aplicación en términos de programación.

Respecto a los coeficientes estimados del modelo, se encontró que Amazon genera en promedio una prima de riesgo del 1%, manteniendo todo lo demás constante, y que su sensibilidad a los movimientos del mercado es amplificada, 1.27 veces los cambios en la prima de mercado del NASDAQ.

En cuanto a la calidad y utilidad del modelo en términos de pronóstico, se evaluó con datos dentro y fuera de muestra, y se concluye que el error de estimación se ubica entre 4.5% a 5%, y que el modelo predice con precisión la dirección del cambio porcentual de Amazon, con una tasa de acierto del 75% al 80%. Se considera que el modelo es muy útil para tomar decisiones de compra o venta de acciones de Amazon y se puede utilizar el valor pronosticado como un take profit o valor objetivo. Sin embargo, es importante tener en cuenta que cuando el pronóstico se encuentra alrededor de 0%, la varianza de las perturbaciones y el error promedio de estimación indican que el activo puede ir en cualquier dirección positiva o negativa.

Se destaca que este modelo está construido de manera sencilla y solo se basa en la información pasada de precios, lo que implica que puede no captar de manera completa otros aspectos que afecten la rentabilidad de Amazon. Además, en términos de utilización del modelo, se observa que la prima de riesgo mensual del NASDAQ y la tasa libre de riesgo, necesarias para pronosticar, no se conocen hasta finales de mes, justo cuando también se conoce el valor de rentabilidad mensual de Amazon. Por lo tanto, como complemento a este modelo, sería interesante construir otro que permita pronosticar los precios del NASDAQ y la tasa libre de riesgo mínimo a un mes adelante. Así se podría utilizar completamente el presente CAPM y pronosticar oportunamente la rentabilidad de la acción de Amazon para tomar decisiones de inversión que generen valor.

## Referencias.

Berk, J. & DeMarzo, P. (2008). El modelo de valuación de activos de capital. *Finanzas Corporativas* (pp. 363-400). Pearson Educación.
